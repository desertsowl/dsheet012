<div class="container">
    <h1 class="mb-2"><%= title %>
        <a href="<%= backLink %>" class="bi bi-arrow-left-circle-fill ms-2 fs-2" style="color: #0d6efe;"></a>
    </h1>
    <% if (documents.length > 0) { %>
        <!-- ページネーション（上部） -->
        <nav class="mb-3">
            <ul class="pagination pagination-sm justify-content-center">
                <!-- 最初のページ -->
                <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>" style="white-space: nowrap;">
                    <a class="page-link px-2 py-1" href="<%= currentPage === 1 ? '#' : '?page=1&groupStart=1' %>">最初</a>
                </li>

                <!-- 前の5ページ -->
                <% const previousSetStart = Math.max(1, groupStart - 5); %>
                <li class="page-item <%= groupStart === 1 ? 'disabled' : '' %>">
                    <a class="page-link px-2 py-1" href="<%= groupStart === 1 ? '#' : '?page=' + previousSetStart + '&groupStart=' + previousSetStart %>">&lt;</a>
                </li>

                <!-- ページ番号 -->
                <% const pageGroup = Array.from({ length: 5 }, (_, i) => groupStart + i).filter(page => page <= lastPage); %>
                <% pageGroup.forEach(page => { %>
                    <li class="page-item <%= currentPage === page ? 'active' : '' %>">
                        <a class="page-link px-2 py-1" href="?page=<%= page %>&groupStart=<%= groupStart %>"><%= page %></a>
                    </li>
                <% }); %>

                <!-- 次の5ページ -->
                <% const nextSetStart = Math.min(lastPage - 4, groupStart + 5); %>
                <li class="page-item <%= groupStart > lastPage - 5 ? 'disabled' : '' %>">
                    <a class="page-link px-2 py-1" href="<%= groupStart > lastPage - 5 ? '#' : '?page=' + nextSetStart + '&groupStart=' + nextSetStart %>">&gt;</a>
                </li>

                <!-- 最後のページ -->
                <li class="page-item <%= currentPage === lastPage ? 'disabled' : '' %>" style="white-space: nowrap;">
                    <a class="page-link px-2 py-1" href="<%= currentPage === lastPage ? '#' : '?page=' + lastPage + '&groupStart=' + Math.max(1, lastPage - 4) %>">最後</a>
                </li>
            </ul>
        </nav>

        <!-- データテーブル -->
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <% fields.forEach(field => { %>
                            <th><%= field %></th>
                        <% }) %>
                    </tr>
                </thead>
                <tbody>
                    <% documents.forEach(doc => { %>
                        <tr>
                            <% fields.forEach(field => { %>
                                <td><%= doc[field] %></td>
                            <% }) %>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>

        <!-- ページネーション（下部） -->
        <nav class="mt-3">
            <ul class="pagination pagination-sm justify-content-center">
                <!-- 最初のページ -->
                <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>" style="white-space: nowrap;">
                    <a class="page-link px-2 py-1" href="<%= currentPage === 1 ? '#' : '?page=1&groupStart=1' %>">最初</a>
                </li>

                <!-- 前の5ページ -->
                <li class="page-item <%= groupStart === 1 ? 'disabled' : '' %>">
                    <a class="page-link px-2 py-1" href="<%= groupStart === 1 ? '#' : '?page=' + previousSetStart + '&groupStart=' + previousSetStart %>">&lt;</a>
                </li>

                <!-- ページ番号 -->
                <% pageGroup.forEach(page => { %>
                    <li class="page-item <%= currentPage === page ? 'active' : '' %>">
                        <a class="page-link px-2 py-1" href="?page=<%= page %>&groupStart=<%= groupStart %>"><%= page %></a>
                    </li>
                <% }); %>

                <!-- 次の5ページ -->
                <li class="page-item <%= groupStart > lastPage - 5 ? 'disabled' : '' %>">
                    <a class="page-link px-2 py-1" href="<%= groupStart > lastPage - 5 ? '#' : '?page=' + nextSetStart + '&groupStart=' + nextSetStart %>">&gt;</a>
                </li>

                <!-- 最後のページ -->
                <li class="page-item <%= currentPage === lastPage ? 'disabled' : '' %>" style="white-space: nowrap;">
                    <a class="page-link px-2 py-1" href="<%= currentPage === lastPage ? '#' : '?page=' + lastPage + '&groupStart=' + Math.max(1, lastPage - 4) %>">最後</a>
                </li>
            </ul>
        </nav>
    <% } else { %>
        <!-- データがない場合 -->
        <p>データがありません。</p>
        <a href="/manager/device/<%= dbName_device %>/device_import" class="btn btn-primary">登録</a>
    <% } %>
</div>

